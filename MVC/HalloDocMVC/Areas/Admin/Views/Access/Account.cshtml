@using HalloDocService.ViewModels;
@model AdminAccountViewModel;
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Access Edit Page";
    Layout = "~/Views/Shared/_AdminDashboard.cshtml";
}


<main class="Access-Admin-Section container-sm mt-sm-5">
    <div class="d-flex justify-content-end mt-4">
        <a asp-area="Admin" asp-controller="Access" asp-action="Index" class="btn btn-sm back-link"><i
                class="fa-solid fa-chevron-left"></i> Back</a>
    </div>
    <div class="d-flex mt-4">
        <h4 class="fw-bold">Create Admin Account</h4>
    </div>
    <div class="p-4 mt-3 mb-3 rounded shadow border">
        <form asp-area="admin" asp-controller="Access" asp-action="Account" method="post" id="CreateNewAdmin">
            <h4>Account Information</h4>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <div class="form-floating">
                        <input type="hidden" asp-for="Username" id="UsernameHidden" />
                        <input asp-for="Username" type="text" class="form-control" id="username" placeholder="UserName"
                            disabled>
                        <label asp-for="Username" for="UserName">User Name</label>
                    </div>
                    <span asp-validation-for="Username" class="text-danger"></span>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="form-floating">
                        <input asp-for="Password" type="text" class="form-control" id="Password" placeholder="Password">
                        <label asp-for="Password" for="Password">Password</label>
                    </div>
                    <span asp-validation-for="Password" class="text-danger"></span>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="form-floating">
                        <select asp-for="RoleId" class="form-select" aria-label="Large select example"
                            placeholder="Role">
                            <option selected disabled>Role</option>
                            @foreach (var item in Model.AllRoleList)
                            {
                                <option value="@item.Id">@item.Name</option>
                            }
                        </select>
                        <label asp-for="RoleId" for="Status">Role</label>
                    </div>
                    <span asp-validation-for="RoleId" class="text-danger"></span>
                </div>
            </div>

            <div class="adminInfo mt-3 mb-3">
                <h4>Administrator Information</h4>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="form-floating ">
                            <input asp-for="FirstName" type="text" class="form-control" id="fname"
                                placeholder="first name">
                            <label asp-for="FirstName" for="floatingInput">First Name</label>
                        </div>
                        <span asp-validation-for="FirstName" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating ">
                            <input asp-for="LastName" type="text" class="form-control" id="lname"
                                placeholder="last name">
                            <label asp-for="LastName" for="floatingInput">Last Name</label>
                        </div>
                        <span asp-validation-for="LastName" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating">
                            <input asp-for="Email" type="email" class="form-control" id="Email" placeholder="email">
                            <label asp-for="Email" for="Email">Email</label>
                        </div>
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating">
                            <input asp-for="EmailConfirmation" type="email" class="form-control" id="EmailConfirmation"
                                placeholder="EmailConfirmation">
                            <label asp-for="EmailConfirmation" for="Email">Confirm Email</label>
                        </div>
                        <span asp-validation-for="EmailConfirmation" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating ">
                            <input asp-for="PhoneNumber" id="Mobile" class="form-control" type="tel" oninput="this.value = this.value.replace(/[^0-9]/g, '')" oninput="this.value = this.value.replace(/[^0-9]/g, '')" />
                            <input asp-for="PhoneNumber" type="hidden" id="phone_hidden" name="full_phone" />
                        </div>
                        <span asp-validation-for="PhoneNumber" class="text-danger" id="mobile-valid"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="d-flex flex-wrap gap-2">
                            @{
                                for (int i = 0; i < Model.AllCheckBoxRegionList.Count(); i++)
                                {
                                    <div class="form-check">
                                        <input type="hidden" asp-for="@Model.AllCheckBoxRegionList[i].Id">
                                        <input class="form-check-input" type="checkbox"
                                            asp-for="@Model.AllCheckBoxRegionList[i].IsSelected"
                                            id="check-@Model.AllCheckBoxRegionList[i].Id">
                                        <label class="form-check-label" for="check-@Model.AllCheckBoxRegionList[i].Id">
                                            @Model.AllCheckBoxRegionList[i].Name
                                        </label>
                                    </div>
                                }
                            }
                        </div>
                        <span id="check-error" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="MailingInfo mt-3 mb-3">
                <h4>Mailing & Billing Information</h4>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="form-floating ">
                            <input asp-for="Address1" type="text" class="form-control" id="Address1"
                                placeholder="Address1">
                            <label asp-for="Address1" for="Address1">Address1</label>
                        </div>
                        <span asp-validation-for="Address1" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating ">
                            <input asp-for="Address2" type="text" class="form-control" id="Address2"
                                placeholder="Address2">
                            <label asp-for="Address2" for="Address2">Address2</label>
                        </div>
                        <span asp-validation-for="Address2" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating ">
                            <input asp-for="City" type="text" class="form-control" id="city" placeholder="city">
                            <label asp-for="City" for="city">City</label>
                        </div>
                        <span asp-validation-for="City" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating ">
                            <select asp-for="State" class="form-select" aria-label="Large select example"
                                placeholder="State">
                                <option selected disabled>State</option>
                                @foreach (var item in Model.AllRegionsList)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                            <label asp-for="State" for="Status">State</label>
                        </div>
                        <span asp-validation-for="State" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating">
                            <input asp-for="Zip" type="text" class="form-control" id="zipcode" placeholder="zipcode">
                            <label asp-for="Zip" for="zipcode">Zip Code</label>
                        </div>
                        <span asp-validation-for="Zip" class="text-danger"></span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-floating">
                            <input asp-for="AlternatePhone" id="Phone" class="form-control" type="tel" oninput="this.value = this.value.replace(/[^0-9]/g, '')" oninput="this.value = this.value.replace(/[^0-9]/g, '')"/>
                            <input asp-for="AlternatePhone" type="hidden" id="phone_hidden_1" name="full_phone" />
                        </div>
                        <span asp-validation-for="AlternatePhone" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-end">
                <button type="button" class="btn btn-success" onclick="submitMyForm()">Create Account</button>
            </div>
        </form>
    </div>
</main>
<script>
    var firstNameField = $('#fname');
    var lastNameField = $('#lname');
    var usernameField = $('#username');

    firstNameField.on('input', updateUsername);
    lastNameField.on('input', updateUsername);

    function updateUsername() {
        var firstName = firstNameField.val().trim().toLowerCase().charAt(0).toUpperCase() + firstNameField.val().trim().toLowerCase().slice(1);
        var lastName = lastNameField.val().trim().toLowerCase().charAt(0).toUpperCase() + lastNameField.val().trim().toLowerCase().slice(1);
        var username = (lastName + firstName).replace(/\s+/g, '');
            usernameField.val(username);
        $("#UsernameHidden").val(username);
    }
    function submitMyForm() {

        CheckBoxValidationError($(`input[type="checkbox"][name^="AllCheckBoxRegionList"][data-val="true"]:checked`),'#check-error');
        AddCountryCode();
        $(`#CreateNewAdmin`).submit();
    }

</script>

@* <script>
    function CheckBoxValidationError(,errorDiv){
        var checkboxesChecked = $(`input[type="checkbox"][name^="AllCheckBoxRegionList"][data-val="true"]:checked`).length;
        if (checkboxesChecked === 0) {
            $(`${errorDiv}`).html('Please check at least one checkbox.');
        } else {
            $(`${errorDiv}`).html('');
        }
    }
</script> *@
