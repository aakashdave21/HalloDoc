@using HalloDocService.ViewModels;
@model ProviderLocationViewModel;
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Provider Page";
    Layout = "~/Views/Shared/_AdminDashboard.cshtml";
    string locationDetailsJson = Newtonsoft.Json.JsonConvert.SerializeObject(Model.ProviderLocationList);
}

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
    #map {
        min-height: 75vh;
        width: 100%;
        z-index: 0;
    }
</style>

<div id="map" class="mt-sm-5"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    var locationLists = @Html.Raw(locationDetailsJson);
    var redIcon = L.icon({
        iconUrl: 'https://cdn.iconscout.com/icon/free/png-512/free-location-2889912-2397879.png?f=webp&w=256',
        iconSize: [40, 40],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
    });
    var markers = locationLists.map(function (location) {
        var lat = location.Latitude;
        var lng = location.Longitude;
        var name = location.PhyicianName;
        var Address = location.Address;
        var marker = L.marker([lat, lng], { icon: redIcon });
        marker.bindPopup(`${name},${Address}`);

        return marker;
    });
    var map = L.map('map', {
        center: [51.5, -0.09],
        zoom: 5,
        maxZoom: 25,
        minZoom: 1,
        maxBounds: [
            [-90, -180],
            [90, 180]
        ]
    });
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
    console.log(locationLists);
    markers.forEach(function (marker) {
        marker.addTo(map);
    });
    $("#adminDashTab li").each(function () {
        if ($(this).data("id") == 2) {
            $("#adminDashTab li a").removeClass("active");
            $(this).addClass("active").find("a").addClass("active");
        }
    })
</script>
